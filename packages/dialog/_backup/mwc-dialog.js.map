{"version":3,"file":"mwc-dialog.js","sourceRoot":"","sources":["src/mwc-dialog.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\nimport {\n    BaseElement,\n    customElement,\n    Foundation,\n    Adapter,\n    html,\n    property,\n    query,\n    observer,\n    queryAll,\n    classMap\n} from \"@authentic/mwc-base/base-element\";\nimport { closest, matches } from '@material/dom/ponyfill';\nimport MDCDialogFoundation from \"@material/dialog/foundation\";\nimport { strings } from \"@material/dialog/constants\";\n// Commented due to focus-trap not working\n// import * as createFocusTrap from 'focus-trap';\n// import * as util from '@material/dialog/util';\nimport { emit } from '@authentic/mwc-base/utils';\nimport { Button as MWCButton } from '@authentic/mwc-button';\n\nimport { style } from './mwc-dialog-css.js';\nimport 'wicg-inert/dist/inert.js';\nimport 'blocking-elements/blocking-elements.js';\n\n// elements to be registered ahead of time\nimport \"@authentic/mwc-button\";\n\nexport interface DialogFoundation extends Foundation {\n    open(): void;\n    close(): void;\n    handleInteraction(): void;\n    handleDocumentKeydown() :void;\n    layout;\n}\n\nexport declare var DialogFoundation: {\n    prototype: DialogFoundation;\n    new(adapter: Adapter): DialogFoundation;\n};\n\ndeclare global {\n    interface HTMLElementTagNameMap {\n        'mwc-dialog': Dialog;\n    }\n}\n\n@customElement('mwc-dialog' as any)\nexport class Dialog extends BaseElement {\n\n    protected mdcFoundation!: DialogFoundation;\n\n    protected readonly mdcFoundationClass: typeof DialogFoundation = MDCDialogFoundation;\n\n    @query('.mdc-dialog')\n    protected mdcRoot!: HTMLElement\n\n    @query('.mdc-dialog_container')\n    protected container!: HTMLElement;\n\n    @query('.mdc-dialog__content')\n    protected content!: HTMLElement;\n\n    @query('.mdc-dialog__scrim')\n    protected scrim!: HTMLElement;\n\n    @queryAll('[data-mdc-dialog-action]')\n    protected buttons!: MWCButton[];\n\n    @query('slot[name=\"footer\"]')\n    protected footerSlot!: HTMLSlotElement;\n\n    @property({ type: String })\n    headerLabel = '';\n\n    @property({ type: String })\n    acceptLabel = 'OK';\n\n    @property({ type: String })\n    declineLabel = 'Cancel';\n\n    @property({ type: Boolean })\n    scrollable = false;\n\n    @property({ type: Boolean })\n    @observer(function(this: Dialog, value: boolean) {\n        if (value) {\n            this.show();\n        } else {\n            this.close();\n        }\n    })\n    opened = false;\n\n    get _buttons(): MWCButton[] {\n        const actionButtons = [...this.buttons] || [];\n        const slottedButtons = this.footerSlot\n            ? this.footerSlot\n                .assignedNodes({flatten: true})\n                .filter(node => node instanceof MWCButton)\n            : [];\n\n        return [\n            ...actionButtons,\n            ...slottedButtons\n        ] as MWCButton[];\n    }\n\n    get _defaultButton() {\n        return this._buttons.filter(item => item.classList.contains('is-default'))[0];\n    }\n\n    // Commented due to focus-trap not working\n    // protected _focusTrap;\n    protected _layout;\n\n    protected createAdapter() {\n        return {\n            ...super.createAdapter(),\n            addClass: (className) => this.mdcRoot.classList.add(className),\n            removeClass: (className) => this.mdcRoot.classList.remove(className),\n            hasClass: (className) => this.mdcRoot.classList.contains(className),\n            addBodyClass: (className) => document.body.classList.add(className),\n            removeBodyClass: (className) => document.body.classList.remove(className),\n            eventTargetMatches: (target, selector) => matches(target, selector),\n            // Commented due to focus-trap not working\n            // trapFocus: () => this._focusTrap && this._focusTrap.activate(),\n            // releaseFocus: () => this._focusTrap && this._focusTrap.deactivate(),\n            // isContentScrollable: () => !!this.content && util.isScrollable(this.content),\n            // areButtonsStacked: () => util.areTopsMisaligned(this._buttons),\n            getActionFromEvent: (event) => {\n                const element = closest(event.target, `[${strings.ACTION_ATTRIBUTE}]`);\n                return element && element.getAttribute(strings.ACTION_ATTRIBUTE);\n            },\n            clickDefaultButton: () => {\n                if (this._defaultButton) {\n                    this._defaultButton.click();\n                }\n            },\n            reverseButtons: () => {\n                this._buttons.reverse();\n                this._buttons.forEach((button) => button.parentElement!.appendChild(button));\n            },\n            notifyOpening: () => {\n                this.opened = true;\n                emit(this, strings.OPENING_EVENT, {});\n            },\n            notifyOpened: () => emit(this, strings.OPENED_EVENT, {}),\n            notifyClosing: (action) => emit(this, strings.CLOSING_EVENT, action ? {action} : {}),\n            notifyClosed: (action) => {\n                this.opened = false;\n                emit(this, strings.CLOSED_EVENT, action ? { action } : {});\n            },\n        }\n    }\n\n    protected _handleInteraction!: EventListenerOrEventListenerObject;\n    protected _handleDocumentKeydown!: EventListenerOrEventListenerObject;\n    protected _handleOpening!: EventListenerOrEventListenerObject;\n    protected _handleClosing!: EventListenerOrEventListenerObject;\n\n    firstUpdated() {\n        // Commented due to focus-trap not working\n        // this._focusTrap = util.createFocusTrapInstance(this.container, createFocusTrap, null);\n        super.firstUpdated();\n\n        this._handleInteraction = this.mdcFoundation.handleInteraction.bind(this.mdcFoundation);\n        this._handleDocumentKeydown = this.mdcFoundation.handleDocumentKeydown.bind(this.mdcFoundation);\n        this._layout = this.mdcFoundation.layout.bind(this.mdcFoundation);\n\n        const LAYOUT_EVENTS = ['resize', 'orientationchange'];\n        this._handleOpening = () => {\n            LAYOUT_EVENTS.forEach(type => window.addEventListener(type, this._layout));\n            document.addEventListener('keydown', this._handleDocumentKeydown);\n        };\n        this._handleClosing = () => {\n            LAYOUT_EVENTS.forEach(type => window.removeEventListener(type, this._layout));\n            document.removeEventListener('keydown', this._handleDocumentKeydown);\n        };\n\n        this.addEventListener('keydown', this._handleInteraction);\n        this.addEventListener(strings.OPENING_EVENT, this._handleOpening);\n        this.addEventListener(strings.CLOSING_EVENT, this._handleClosing);\n\n        this.scrim.addEventListener('click', this._handleInteraction);\n        this._buttons\n            .filter(el => !!el.getAttribute('data-mdc-dialog-action'))\n            .forEach(el => {\n                el.addEventListener('click', this._handleInteraction);\n            });\n    }\n\n    static styles = style;\n\n    render() {\n        const { headerLabel, acceptLabel, declineLabel, scrollable } = this;\n        return html`\n            <aside class=\"mdc-dialog\"\n                role=\"alertdialog\"\n                aria-labelledby=\"my-dialog-title\"\n                aria-describedby=\"my-dialog-content\">\n                <div class=\"mdc-dialog_container\">\n                    <div class=\"mdc-dialog__surface\">\n                        <header class=\"mdc-dialog__header\">\n                            <h2 id=\"my-dialog-title\" class=\"mdc-dialog__title\">${headerLabel}</h2>\n                            <slot name=\"header\"></slot>\n                        </header>\n                        <section id=\"my-dialog-content\" class=\"mdc-dialog__content ${classMap({'mdc-dialog__body--scrollable': scrollable})}\">\n                            <slot></slot>\n                        </section>\n                        <footer class=\"mdc-dialog__actions\">\n                            <slot name=\"footer\"></slot>\n                            ${this.renderButton(declineLabel, 'cancel')}\n                            ${this.renderButton(acceptLabel, 'accept', true)}\n                        </footer>\n                    </div>\n                </div>\n                <div class=\"mdc-dialog__scrim\"></div>\n            </aside>\n        `;\n    }\n\n    renderButton(label: String, action: String, isDefault: boolean = false) {\n        const classes = {\n            'is-default': isDefault\n        };\n\n        return html`<mwc-button data-mdc-dialog-action=\"${action}\" class=\"${classMap(classes)}\" label=\"${label}\"></mwc-button>`;\n    }\n\n    show() {\n        this.mdcFoundation.open();\n    }\n\n    close() {\n        this.mdcFoundation.close();\n    }\n\n}\n"]}
